<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <title>FindMyCar - Teste de Recomendação</title>
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='styles/questionario.css') }}"
    />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="../static/styles/questionario.css">

  </head>
  <style>
  footer input::placeholder {
    color: rgba(255, 255, 255, 0.7);
    opacity: 1;
  }
</style>
  <body>
    <div id="app">
        <nav class="navbar navbar-expand-md navbar-dark py-3 px-5" style="background-color: rgb(95, 103, 116); backdrop-filter: blur(6px);">
            <div class="container-fluid px-3 d-flex flex-column flex-md-row align-items-center justify-content-between">
                <ul class="navbar-nav flex-row flex-wrap justify-content-center order-2 order-md-1 mt-2 mt-md-0 ps-3">
                    <li class="nav-item mx-2">
                        <a class="nav-link text-white-75" href="/">Home</a>
                    </li>
                    <li class="nav-item mx-2">
                        <a class="nav-link text-white-75" href="/">Ficha</a>
                    </li>
                    <li class="nav-item mx-2">
                        <a class="nav-link text-white-75" href="/">Carros</a>
                    </li>
                    <li class="nav-item mx-2">
                        <a class="nav-link text-white-75" href="/questionario">Teste</a>
                    </li>
                    <li class="nav-item mx-2">
                        <a class="nav-link text-white-75" href="/">Sobre</a>
                    </li>
                </ul>

                <a class="navbar-brand order-1 order-md-2 fw-semibold d-flex" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%)" href="#">FindMyCar</a>

                <div class="dropdown order-3">
                    <button type="button" class="btn text-white" style="background-color: rgba(95, 103, 116, 0.9);">
                        {{session['user']['email']}}
                    </button>
                    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="profileDropdown">
                      <li><a class="dropdown-item" href="/perfil">
                          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-person-fill" viewBox="0 0 16 16" style="margin-right: 8px;">
                            <path d="M3 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1H3zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/>
                          </svg>
                          Perfil
                      </a></li>
                      <li><a class="dropdown-item" href="/configuracoes">
                          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-gear-fill" viewBox="0 0 16 16" style="margin-right: 8px;">
                            <path d="M9.405 1.05c-.413-1.4-2.397-1.4-2.81 0l-.1.34a1.464 1.464 0 0 1-2.105.872l-.31-.17c-1.283-.698-2.686.705-1.987 1.987l.169.311a1.464 1.464 0 0 1 .872 2.105l-.34.1c-1.4.413-1.4 2.397 0 2.81l.34.1a1.464 1.464 0 0 1-.872 2.105l-.17.31c-.698 1.283.705 2.686 1.987 1.987l.311-.169a1.464 1.464 0 0 1 2.105.872l.1.34c.413 1.4 2.397 1.4 2.81 0l.1-.34a1.464 1.464 0 0 1 2.105-.872l.31.17c1.283.698 2.686-.705 1.987-1.987l-.169-.311a1.464 1.464 0 0 1 .872-2.105l.34-.1c1.4-.413-1.4-2.397 0-2.81l.34-.1a1.464 1.464 0 0 1-.872-2.105l.17-.31c.698-1.283-.705-2.686-1.987-1.987l-.311.169a1.464 1.464 0 0 1-2.105-.872l-.1-.34zM8 10.93a2.929 2.929 0 1 1 0-5.858 2.929 2.929 0 0 1 0 5.858z"/>
                          </svg>
                          Configurações
                      </a></li>
                      <li><hr class="dropdown-divider"></li>
                      <li><a class="dropdown-item" href="/logout">
                          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-right" viewBox="0 0 16 16" style="margin-right: 8px;">
                            <path fill-rule="evenodd" d="M10 12.5a.5.5 0 0 1-.5.5h-8a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5h8a.5.5 0 0 1 .5.5v2a.5.5 0 0 0 1 0v-2A1.5 1.5 0 0 0 9.5 2h-8A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h8a1.5 1.5 0 0 0 1.5-1.5v-2a.5.5 0 0 0-1 0v2z"/>
                            <path fill-rule="evenodd" d="M15.854 8.354a.5.5 0 0 0 0-.708l-3-3a.5.5 0 0 0-.708.708L14.293 7.5H5.5a.5.5 0 0 0 0 1h8.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3z"/>
                          </svg>
                          Logout
                      </a></li>
                    </ul>
                </div>
            </div>
        </nav>

      <main class="quiz_container">
        <h1>Teste de Recomendação</h1>

        <h2>[[ perguntaAtual.desc_pergunta ]]</h2>

        <div class="progress">
          <div
            class="progress-bar"
            role="progressbar"
            :style="{ width: progressPercentage + '%' }"
            :aria-valuenow="progressPercentage"
            aria-valuemin="0"
            aria-valuemax="100"
          ></div>
        </div>
        <div class="options">
          <button
            v-for="n in 5"
            :key="n"
            @click="responderPergunta(n)"
            :class="['option', getOptionColorClass(n)]"
            :data-value="n"
          >
            <br /><span>[[ getOptionDescription(n) ]]</span>
          </button>
        </div>
      </main>

    <style>
      footer input::placeholder {
        color: rgba(255, 255, 255, 0.6);
        opacity: 1;
      }
    </style>

    <footer class="text-white pt-5 pb-0" style="background-color: #0F111E;">
      <div class="container pb-4"> <div class="row g-4">

          <div class="col-md-4">
            <h2 class="h5 fw-semibold mb-3">FindMyCar</h2>
            <p class="mb-3 text-light">Busque menos. Viva mais.</p>
            <form class="d-flex rounded-pill overflow-hidden" style="background-color: #2A2D3E;">
              <input
                id="input-email"
                type="email"
                class="form-control border-0 text-white"
                placeholder="Seu endereço de email"
                style="background-color: #2A2D3E;"
              />
              <button
                type="submit"
                class="btn rounded-pill"
                style="background-color: #4C65F1; color: #fff; white-space: nowrap;"
              >
                Cadastre-se
              </button>
            </form>
          </div>

          <div class="col-6 col-md-2">
            <h6 class="fw-semibold mb-3">Sobre a Empresa</h6>
            <ul class="list-unstyled small">
              <li><a href="#" class="text-light text-decoration-none d-block mb-1">Sobre nós</a></li>
              <li><a href="#" class="text-light text-decoration-none d-block mb-1">Serviços</a></li>
              <li><a href="#" class="text-light text-decoration-none d-block mb-1">Termos</a></li>
              <li><a href="#" class="text-light text-decoration-none d-block mb-1">Contato</a></li>
            </ul>
          </div>

          <div class="col-6 col-md-2">
            <h6 class="fw-semibold mb-3">Links Rápidos</h6>
            <ul class="list-unstyled small">
              <li><a href="#" class="text-light text-decoration-none d-block mb-1">Teste</a></li>
              <li><a href="#" class="text-light text-decoration-none d-block mb-1">Anuncie</a></li>
              <li><a href="#" class="text-light text-decoration-none d-block mb-1">Suporte</a></li>
            </ul>
          </div>

          <div class="col-6 col-md-2">
            <h6 class="fw-semibold mb-3">Marcas</h6>
            <ul class="list-unstyled small">
              <li><a href="#" class="text-light text-decoration-none d-block mb-1">Toyota</a></li>
              <li><a href="#" class="text-light text-decoration-none d-block mb-1">Porsche</a></li>
              <li><a href="#" class="text-light text-decoration-none d-block mb-1">Audi</a></li>
              <li><a href="#" class="text-light text-decoration-none d-block mb-1">BMW</a></li>
              <li><a href="#" class="text-light text-decoration-none d-block mb-1">Ford</a></li>
              <li><a href="#" class="text-light text-decoration-none d-block mb-1">Nissan</a></li>
              <li><a href="#" class="text-light text-decoration-none d-block mb-1">Peugeot</a></li>
              <li><a href="#" class="text-light text-decoration-none d-block mb-1">Volkswagen</a></li>
            </ul>
          </div>

          <div class="col-6 col-md-2">
            <h6 class="fw-semibold mb-3">Tipos</h6>
            <ul class="list-unstyled small">
              <li><a href="#" class="text-light text-decoration-none d-block mb-1">Sedan</a></li>
              <li><a href="#" class="text-light text-decoration-none d-block mb-1">Hatchback</a></li>
              <li><a href="#" class="text-light text-decoration-none d-block mb-1">SUV</a></li>
              <li><a href="#" class="text-light text-decoration-none d-block mb-1">Híbrido</a></li>
              <li><a href="#" class="text-light text-decoration-none d-block mb-1">Elétrico</a></li>
              <li><a href="#" class="text-light text-decoration-none d-block mb-1">Caminhonete</a></li>
              <li><a href="#" class="text-light text-decoration-none d-block mb-1">Van</a></li>
              <li><a href="#" class="text-light text-decoration-none d-block mb-1">Conversível</a></li>
            </ul>
          </div>
        </div>
      </div>

      <div class="border-top border-secondary mt-4 pt-3 px-3 pb-2" style="width: 100%;">
        <div class="d-flex justify-content-between align-items-center flex-column flex-md-row text-secondary small">
          <p class="mb-2 mb-md-0">© 2025 FindMyCar. Todos os direitos reservados.</p>
          <nav class="d-flex gap-3">
            <a href="#" class="text-secondary text-decoration-none">Termos e Política</a>
            <span aria-hidden="true">•</span>
            <a href="#" class="text-secondary text-decoration-none">Privacidade</a>
          </nav>
        </div>
      </div>
    </footer>

    </div>

    <script src="https://cdn.jsdelivr.net/npm/vue@2"></script>
    <script>
      new Vue({
        el: "#app",
        delimiters: ["[[", "]]"],

        data() {
          return {
            perguntas: [
              {
                numero_pergunta: 1,
                desc_pergunta:
                  "O quanto o conforto interno importa na sua decisão?",
                resposta_pergunta: 0,
              },
              {
                numero_pergunta: 2,
                desc_pergunta:
                  "Qual a sua prioridade em termos de economia de combustível?",
                resposta_pergunta: 0,
              },
              {
                numero_pergunta: 3,
                desc_pergunta: "Qual a importância do espaço de seu carro?",
                resposta_pergunta: 0,
              },
              {
                numero_pergunta: 4,
                desc_pergunta:
                  "Qual a importância do preço de compra de um carro novo?",
                resposta_pergunta: 0,
              },
              {
                numero_pergunta: 5,
                desc_pergunta: "Qual a importância do preço de manutenção?",
                resposta_pergunta: 0,
              },
            ],
            i_pergunta_atual: 0,
          };
        },
        computed: {
          perguntaAtual() {
            if (this.i_pergunta_atual >= this.perguntas.length) {
              return this.perguntas[this.perguntas.length - 1];
            }
            return this.perguntas[this.i_pergunta_atual];
          },
          progressPercentage() {
            if (this.perguntas.length === 0) return 0;
            return (this.i_pergunta_atual / this.perguntas.length) * 100;
          },
          progressLabel() {
            return `${this.i_pergunta_atual + 1}/${this.perguntas.length}`;
          },
        },
        methods: {
          responderPergunta: function (resposta) {
            this.perguntas[this.i_pergunta_atual].resposta_pergunta = resposta;

            if (this.i_pergunta_atual < this.perguntas.length - 1) {
              this.i_pergunta_atual++;
            } else {
              console.log("Todas as perguntas foram respondidas.");
              console.log("Respostas Finais:", this.perguntas);

              // Montar o payload
              const payload = {
                conforto: this.perguntas[0].resposta_pergunta,
                consumo: this.perguntas[1].resposta_pergunta,
                tamanho: this.perguntas[2].resposta_pergunta,
                preco: this.perguntas[3].resposta_pergunta,
                manutencao: this.perguntas[4].resposta_pergunta,
              };
              console.log(payload);

              // Enviar para o back-end
              fetch("/api/recomendar", {
                method: "POST",
                headers: {
                  "Content-Type": "application/json",
                },
                body: JSON.stringify(payload),
              })
                .then((response) => response.json())
                .then((data) => {
                  window.location.href = "/recomendacao"; // página que mostrará o resultado
                })
                .catch((error) => {
                  console.error("Erro ao obter recomendação:", error);
                });
            }
          },
          getOptionColorClass(value) {
            const classes = {
              1: "red",
              2: "orange",
              3: "yellow",
              4: "lightgreen",
              5: "green",
            };
            return classes[value];
          },
          getOptionDescription(value) {
            const descriptions = {
              1: "Nada importante",
              2: "Pouco importante",
              3: "Neutro",
              4: "Importante",
              5: "Muito importante",
            };
            return descriptions[value];
          },
        },
      });
    </script>
  </body>
</html>